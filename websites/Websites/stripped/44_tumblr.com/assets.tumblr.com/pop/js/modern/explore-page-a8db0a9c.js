"use strict";(self.webpackChunk_tumblr_redpop=self.webpackChunk_tumblr_redpop||[]).push([[6341],{27178:(e,t,s)=>{s.d(t,{Z:()=>T});var i=s(95004),n=s(99965),a=s(13883),o=s(42580),l=s(43523),r=s(64633),d=s(42946),h=s(78667),c=s(58849),g=s(80328),p=s(63583),m=s.n(p),u=s(2629);const T=function(e){let{title:t,subtitle:s,signupText:p,source:T=r.yy.ExploreFloatingSignUpCTA,isDismissible:x=!0,showOnScroll:f=!1,isFloating:C=!0,textColor:S=m().white,backgroundColor:b=m().zunePurple}=e;const{_t:R,_c:v,getCookie:w,setCookie:F,logEvent:M}=(0,h.bp)(),{openLoginWall:j}=(0,c.h)(),k=v("This is a caption for a button indicating that the user doesn't want to sign up now, but we're optimistic that they will sign up later. Should be kept short to fit smaller form factors.","Maybe later"),P=p??R("Sign me up"),y=t??R("It's time to try Tumblr"),E=s??v("This is our website bragging to a potential user about how great our content is","You'll never be bored again."),I=(0,i.useCallback)((()=>{const e=new Date(Date.now()+d.g.Week);F(a.zC.SIGN_UP_CTA_DISMISSED,a.Ox,{expires:e}),M({eventName:l.J.SignUpCTAClickDismiss})}),[M,F]),N=(0,g.Z)(T),L=(0,i.useCallback)((e=>{null==e||e.preventDefault(),M({eventName:l.J.SignUpCTAClickRegister}),j({form:o.c.Register,source:N})}),[]);return w(a.zC.SIGN_UP_CTA_DISMISSED)===a.Ox||w(a.zC.LOGGED_IN)===a.Ox?null:(0,u.jsx)(n.Z,{title:y,subtitle:E,showOnScroll:f,floating:C,dismissButtonCallback:I,...x&&{dismissButtonCaption:k},confirmButtonCaption:P,centered:!x,onConfirm:L,color:S,background:b})}},44513:(e,t,s)=>{s.r(t),s.d(t,{ExplorePage:()=>De,default:()=>Oe});var i=s(50209),n=s.n(i),a=s(86179),o=s(27178),l=s(6930),r=s(95004),d=s(79615),h=s(67043),c=s(78667),g=s(14544),p=s(99693),m=s(63583),u=s.n(m);const T="osUS3",x="u24HE",f="sADin";var C=s(2629);const S=e=>{let{paletteToggled:t=!1}=e;const{_c:s,_t:i}=(0,c.bp)(),n=(0,g.M)(),a=(0,p.QL)(n.name,s),[o,l]=(0,r.useState)(t),m=o?a:i("Change Palette");return(0,C.jsx)("div",{className:T,children:(0,C.jsxs)(d.Z,{label:i("Change Palette"),className:x,wrapperStyle:{width:"100%"},type:"button",onClick:()=>{n.togglePalette(),l(!0)},children:[(0,C.jsx)("div",{className:f,children:(0,C.jsx)(h.Z,{size:{width:20,height:20},colors:{primary:u().paletteAccent}})}),m]})})};var b=s(5754),R=s.n(b),v=s(73683),w=s(90855),F=s(48451),M=s(54382),j=s(65214),k=s(43523),P=s(59215),y=s(96467);const E="nKYyP",I="CXVtW",N="vT7_j",L="yTeF1",B="CJe61",D="k_NNN",O="jofje",Z="sEVNj",_="o6N4U",A="y6JFX",V="FSlaf",U="gREXw",z="iAQuj",G="S227z",W="VUHVZ",Q="IWDxU";class $ extends r.Component{constructor(){super(...arguments),n()(this,"state",{isCollapsed:!0}),n()(this,"maxTagsToDisplay",8),n()(this,"maxRelatedTagsToDisplay",3),n()(this,"avatarSize",64),n()(this,"collapsedTagsCount",4),n()(this,"showAllTags",(()=>{this.setState({isCollapsed:!1})})),n()(this,"renderMobile",((e,t)=>{const{_t:s}=this.props.appContext;return(0,C.jsxs)("div",{className:R()(G,{[Q]:!!this.state.isCollapsed}),children:[(0,C.jsx)("div",{className:W,children:(0,C.jsx)("ol",{className:e,children:t.map(this.renderItem)})}),this.state.isCollapsed&&t.length>this.collapsedTagsCount&&(0,C.jsx)(d.Z,{wrapperClassName:U,className:z,onClick:this.showAllTags,label:s("Show More"),children:(0,C.jsx)(M.ZP,{children:"Show More"})})]})})),n()(this,"renderItem",((e,t)=>{const{appContext:{isLoggedIn:s}}=this.props,i=(0,j.fO)(e.label);return t<this.maxTagsToDisplay&&(0,C.jsx)("div",{className:N,children:(0,C.jsxs)("li",{"data-index":t+1,children:[(0,C.jsx)(v.rU,{className:L,to:i,onClick:()=>this.logUserClickedOnTagCard(e.label),...!s&&{"data-login-wall-type":"tags","data-login-wall-tag-label":e.label,"data-login-wall-destination":i,"data-login-wall-redirect":i}}),(0,C.jsxs)("div",{className:D,children:[(0,C.jsx)("span",{className:B,children:e.label}),(0,C.jsx)("div",{className:Z,children:this.renderRelatedTags(e)})]}),(0,C.jsx)("div",{className:_,style:{width:`${this.avatarSize}px`},children:this.renderImage(e)})]})},`trending-tag-${e.label}`)})),n()(this,"renderImage",(e=>{var t,s;return null!=e&&null!==(t=e.resources)&&void 0!==t&&null!==(s=t[0])&&void 0!==s&&s.thumbUrl?(0,C.jsx)(F.pC,{imageResponse:this.getImageResponseFromTagResource(e.resources[0]),altText:e.label,sizes:`${this.avatarSize}px`}):(0,C.jsx)("div",{className:A,style:{width:`${this.avatarSize}px`,height:`${this.avatarSize}px`}})})),n()(this,"logUserClickedOnTagCard",(e=>this.props.appContext.logEvent({eventName:k.J.ClickedOnTagCard,eventDetails:{tag:e}}))),n()(this,"getImageResponseFromTagResource",(e=>[{url:e.thumbUrl,width:this.avatarSize,height:this.avatarSize}])),n()(this,"renderRelatedTags",(e=>e.relatedTags.reduce(((e,t)=>{const{appContext:{isLoggedIn:s}}=this.props,i=(0,j.fO)(t);return e.length<this.maxRelatedTagsToDisplay?[...e,(0,C.jsx)(v.rU,{to:i,className:O,onClick:()=>this.logUserClickedOnTagCard(t),...!s&&{"data-login-wall-type":"tags","data-login-wall-tag-label":t,"data-login-wall-destination":i,"data-login-wall-redirect":i},children:`#${t} `},`related-tag-${t}`)]:e}),[])))}render(){const{isMobile:e,items:t,columns:s,topPositioned:i}=this.props,n=R()(E,{[I]:!!i}),a=y.timelineMasonryPostWidth+y.timelineMasonryPostSpacing;return e?this.renderMobile(n,t):(0,C.jsx)("ol",{className:n,children:(0,C.jsxs)(w.Z,{visibleWidth:a*s-y.timelineMasonryPostSpacing/2,itemWidth:a,children:[this.getColumn(0,1),this.getColumn(2,3),this.getColumn(4,5),this.getColumn(6,7)]})})}getColumn(e,t){const{items:s}=this.props,i=s[e],n=s[t];return(0,C.jsxs)("div",{className:V,children:[i&&this.renderItem(i,e),n&&this.renderItem(n,t)]})}}n()($,"defaultProps",{items:[],columns:4,isMobile:!1});const H=(0,P.X9)($,{appContext:!0,loginContext:!0});var J=s(13434),K=s(70746),Y=s(91546),X=s(75379),q=s(97187),ee=s(26622),te=s(46675),se=s(92587),ie=s(32468),ne=s(13883),ae=s(18046),oe=s(92183),le=s(74105),re=s(22979),de=s(86694),he=s(20943),ce=s(93099),ge=s(399),pe=s(58546),me=s(48385),ue=s(75891),Te=s(68782),xe=s(94576),fe=s(31726);const Ce="V9TEa",Se="V2QpM",be="EHHOR",Re="VbmN8",ve="gfrwY",we="qY_MN",Fe="Fd3xx",Me="PbqCW",je="SmuUJ",ke="PygP1",Pe=e=>!(null==e||!e.trendingBlogsTimeline),ye=e=>!(null==e||!e.recommendedBlogsTimeline),Ee=e=>!(null==e||!e.followedTagsTimeline),Ie=e=>!(0,pe.Q)(e.timeline),Ne=e=>!(null==e||!e.trendingTagsTimeline),Le=e=>!(null==e||!e.recommendedTagsTimeline),Be=e=>!(null==e||!e.staffPicksTagsTimeline);class De extends le.lb{constructor(){super(...arguments),n()(this,"state",this.getInitialState()),n()(this,"translatedTextForModeTitle",(()=>{const{_t:e}=this.props.appContext;return{[ae.Ru.Recommended]:e("For You ðŸ”®"),[ae.Ru.StaffPicks]:e("Staff Picks ðŸŒŸ"),[ae.Ru.Trending]:e("Trending ðŸš€"),[ae.Ru.Gifs]:e("GIFs"),[ae.Ru.Video]:e("Videos"),[ae.Ru.Asks]:e("Asks"),[ae.Ru.Audio]:e("Audio"),[ae.Ru.Chats]:e("Chats"),[ae.Ru.Photos]:e("Photos"),[ae.Ru.Quotes]:e("Quotes"),[ae.Ru.Text]:e("Text")}})()),n()(this,"hasFetchedTagCarouselState",(()=>{switch(this.getExploreMode()){case ae.Ru.Trending:return Ne(this.state);case ae.Ru.Recommended:return Le(this.state);case ae.Ru.StaffPicks:return Be(this.state);default:return!0}})),n()(this,"hasFetchedSidebar",(()=>{const{isLoggedIn:e}=this.props.appContext,t=this.getExploreMode();return e?!!Ee(this.state)&&(t===ae.Ru.Trending?Pe(this.state):ye(this.state)):Pe(this.state)})),n()(this,"hasFetchedInitialState",(()=>this.hasFetchedTagCarouselState()&&Ie(this.state))),n()(this,"shouldRedirectToExploreMode",(()=>{const e=this.getExploreMode();return!e||!this.getExploreModes().includes(e)})),n()(this,"getTimelineChangeLinkProps",(e=>({to:(0,ce.Z)(j.o_.exploreByMode,{exploreMode:e}),children:this.translatedTextForModeTitle[e]}))),n()(this,"renderSidebar",(()=>{const{_t:e,isLoggedIn:t,features:{exploreRightRailAds:s}}=this.props.appContext,{followedTagsTimeline:i}=this.state;return this.hasFetchedSidebar()?(0,C.jsxs)(Y.Z,{supplyProviderId:oe.E.EXPLORE,showAd:s,followedTags:t&&i,children:[(0,C.jsx)(ee.Z,{timelineObject:this.getRecommendedBlogs(),displayMode:re.mt.Masonry}),!t&&(0,C.jsx)(o.Z,{backgroundColor:u().betamaxOrange,isFloating:!1,isDismissible:!1,title:e("Curate your own Dashboard"),signupText:e("Sign me up ðŸ™Œ")}),!t&&(0,C.jsx)(S,{})]}):(0,C.jsx)(Y.Z,{allContentSticky:!0,children:(0,C.jsx)("div",{className:Me,children:this.renderLoader()})})})),n()(this,"renderMetaData",(()=>{const{_c:e,_t:t}=this.props.appContext,s={},i=this.getExploreMode(),n=e("Page title for the Explore page","Explore | Tumblr"),a=t("From fandoms to photography, gaming to anime, Tumblr is where your people are.");if(!i)return(0,C.jsx)(K.Z,{title:n,description:a});switch(i){case ae.Ru.Recommended:s.title=t("Recommended for you on Tumblr"),s.description=t("These up-to-date topics are curated just for you. The more you engage with content on Tumblr, the more exciting your personalized recommendations will feel.");break;case ae.Ru.StaffPicks:s.title=t("Staff picks on Tumblr"),s.description=t("These are the best new GIFs, fan art, illustrations, photos on the internet as curated by Tumblr staff.");break;case ae.Ru.Trending:s.title=t("Trending topics on Tumblr"),s.description=t("Explore trending topics on Tumblr. See all of the GIFs, fan art, and general conversation about the internetâ€™s favorite things.");break;default:s.title=this.translatedTextForModeTitle[i]?`${this.translatedTextForModeTitle[i]} | Tumblr`:n,s.description=a}return(0,C.jsx)(K.Z,{...s})})),n()(this,"renderTagsSection",(()=>{const{isViewportMounted:e,width:t}=this.props.viewportContext,{recommendedTagsTimeline:s,trendingTagsTimeline:i,staffPicksTagsTimeline:n}=this.state;if((0,pe.Q)(s)&&(0,pe.Q)(i)&&(0,pe.Q)(n))return null;const a=this.isMobile();switch(this.getExploreMode()){case ae.Ru.Recommended:return(null==s?void 0:s.elements)&&(0,C.jsx)("div",{className:we,children:(0,C.jsx)(te.Z,{timelineObject:s,itemWidth:y.tagCardCarouselItemWidth+y.carouselItemSpacing,loaderClass:"carouselLoaderTagCard"},ae.Ru.Recommended)});case ae.Ru.Trending:return(null==i?void 0:i.elements)&&e&&(0,C.jsx)("div",{className:Fe,children:(0,C.jsx)(H,{isMobile:a,transparent:!0,topPositioned:!0,columns:this.isListView()?2:(0,me.vk)(t,!0),items:i.elements})});case ae.Ru.StaffPicks:return(null==n?void 0:n.elements)&&(0,C.jsx)("div",{className:we,children:(0,C.jsx)(te.Z,{timelineObject:n,itemWidth:y.tagCardCarouselItemWidth+y.carouselItemSpacing,loaderClass:"carouselLoaderTagCard"},ae.Ru.StaffPicks)});default:return null}})),n()(this,"getExploreModes",(()=>{const{isLoggedIn:e}=this.props.appContext;return e?Object.values(ae.Ru):Object.values(ae.Um)})),n()(this,"switchView",(e=>this.setState({displayMode:e},(()=>this.props.appContext.setCookie(ne.zC.TAGGED_DISPLAY_MODE,e))))),n()(this,"renderEmptyTimeline",(()=>(0,C.jsx)("div",{className:Re,children:(0,C.jsx)(M.ZP,{children:"We couldnâ€™t find any posts like that."})}))),n()(this,"getInitialPage",(()=>{var e;const{timeline:t}=this.state,s=t[this.getExploreMode()];return{objects:(null==s?void 0:s.elements)||[],nextLink:null==s||null===(e=s.links)||void 0===e?void 0:e.next}})),n()(this,"getRecommendedBlogs",(()=>{var e;const{isLoggedIn:t}=this.props.appContext,{recommendedBlogsTimeline:s,trendingBlogsTimeline:i}=this.state,n=this.getExploreMode()!==ae.Ru.Trending&&t?s:i;return(0,ue.Z)({elements:null==n||null===(e=n.elements)||void 0===e?void 0:e.filter((e=>e.objectType!==re.RP.Title)),objectType:re.TE.Carousel,id:"id",links:null==n?void 0:n.links},this.getTranslatedTextForBlogsSidebar())})),n()(this,"getTranslatedTextForBlogsSidebar",(()=>{const{_c:e,isLoggedIn:t}=this.props.appContext;return this.getExploreMode()!==ae.Ru.Trending&&t?e("Title for the sidebar section with blogs recommended for the user","Check out these blogs"):e("Title for the sidebar section with trending blogs","Trending Blogs")})),n()(this,"onPagination",(()=>this.props.appContext.logEvent({eventName:k.J.Pagination}))),n()(this,"isListView",(()=>this.isMobile()||this.state.displayMode===re.mt.List)),n()(this,"renderTimelineContent",(()=>{const{isViewportMounted:e}=this.props.viewportContext;if(this.state.isFetchingMainTimeline||!e)return this.renderLoader();const{timelineKey:t}=this.state,s=this.getExploreMode(),i=(0,fe.Aw)(this.props.appContext.apiFetch,s);return(0,C.jsxs)("main",{className:this.isListView()?Ce:Se,children:[s===ae.Ru.Trending&&this.isMobile()&&(0,C.jsx)("div",{className:ke,children:(0,C.jsx)(M.ZP,{children:"Try these posts"})}),(0,C.jsx)(X.Z,{getInitialPage:this.getInitialPage,endpointApiRequest:i,getObjectsFromResponse:this.getTimelineElementsFromResponse,onPagination:this.onPagination,displayMode:this.isListView()?re.mt.List:re.mt.Masonry,maximumNumberOfColumns:fe.GI,masonryRendersWithSidebar:!0,emptyView:this.renderEmptyTimeline(),doesNotRemoveUnfollowedObjects:!0},t)]})})),n()(this,"renderLoader",(()=>(0,C.jsx)("div",{className:ve,children:(0,C.jsx)(J.Z,{centerOrientation:J.Q.HorizontalAndVertical})}))),n()(this,"fetchCurrentTimeline",(()=>{const e=this.getExploreMode();this.setState({isFetchingMainTimeline:!0},(()=>(0,fe.kh)(this.props.appContext.apiFetch,e).then((t=>this.setState({timeline:{...this.state.timeline,[e]:t.timeline[e]},isFetchingMainTimeline:!1,hasFetchError:t.hasFetchError})))))})),n()(this,"getTimelineElementsFromResponse",(e=>{let{response:{timeline:t}}=e;return(null==t?void 0:t.elements)||[]})),n()(this,"getExploreMode",(()=>this.props.params.exploreMode))}getInitialState(){const{getBootstrap:e,getCookie:t,isLoggedIn:s}=this.props.appContext,i=e(fe.Rn),n=s?re.mt.Masonry:re.mt.List;return{displayMode:(t(ne.zC.TAGGED_DISPLAY_MODE)||n)===re.mt.List?re.mt.List:re.mt.Masonry,followedTagsTimeline:null==i?void 0:i.followedTagsTimeline,timeline:(null==i?void 0:i.timeline)||{},recommendedBlogsTimeline:null==i?void 0:i.recommendedBlogsTimeline,trendingBlogsTimeline:null==i?void 0:i.trendingBlogsTimeline,recommendedTagsTimeline:null==i?void 0:i.recommendedTagsTimeline,trendingTagsTimeline:null==i?void 0:i.trendingTagsTimeline,staffPicksTagsTimeline:null==i?void 0:i.staffPicksTagsTimeline,isFetchingMainTimeline:!1,isFetchingTrendingTags:!1,isFetchingRecommendedTags:!1,isFetchingStaffPicksTags:!1,isFetchingFollowedTags:!1,isFetchingTrendingBlogs:!1,isFetchingRecommendedBlogs:!1,hasFetchError:!1,timelineKey:0}}componentDidMount(){this.shouldRedirectToExploreMode()||(Ie(this.state)||this.fetchCurrentTimeline(),this.fetchTags(),this.fetchSidebar())}componentDidUpdate(e){let{params:{exploreMode:t}}=e;const{timeline:s,isFetchingMainTimeline:i,hasFetchError:n,timelineKey:a}=this.state,o=this.getExploreMode();s[o]||i||n?t!==o&&this.hasFetchedInitialState()&&this.setState({timelineKey:a+1}):this.fetchCurrentTimeline(),t!==o&&(this.fetchTags(),this.fetchSidebar())}isMobile(){return(0,xe.wh)(this.props.viewportContext.width)}render(){const{isLoggedIn:e,_t:t}=this.props.appContext,{hasFetchError:s,displayMode:i}=this.state,n=this.isMobile(),r=n?0:`calc(100vh - ${y.desktopHeaderEffectiveHeightPx}px + 1px)`,d=this.getExploreMode();if(this.shouldRedirectToExploreMode())return(0,C.jsx)(a.Fg,{to:(0,j.wT)({exploreMode:e?ae.Ru.Recommended:ae.Ru.Trending}),replace:!0});if(s){const e=(0,Te.U)((0,ge.Pk)(t));return(0,C.jsxs)(l.Z,{activePage:ie.vS.explore,children:[this.renderMetaData(),(0,C.jsx)("div",{className:je,children:e}),";"]})}return this.hasFetchedInitialState()&&d&&this.getExploreModes().includes(d)?(0,C.jsxs)(l.Z,{activePage:ie.vS.explore,children:[this.renderMetaData(),!e&&(0,C.jsx)(o.Z,{}),(0,C.jsx)(se.Z,{innerBorder:!n,maxMasonryColumns:fe.GI,mainContentIsMasonry:!this.isListView(),sidebar:this.renderSidebar(),children:(0,C.jsxs)("div",{style:{minHeight:r},className:be,children:[(0,C.jsx)(q.Z,{timelineOptions:e?[ae.Ru.Recommended,ae.Ru.Trending,ae.Ru.StaffPicks]:[ae.Ru.Trending,ae.Ru.StaffPicks],submenuOptions:ae.PX,viewsShown:[re.mt.List,re.mt.Masonry],onViewClick:this.switchView,currentView:i,activeOption:d,addBottomMargin:d===ae.Ru.StaffPicks,getLinkProps:this.getTimelineChangeLinkProps}),this.renderTagsSection(),this.renderTimelineContent()]})})]}):(0,C.jsxs)(l.Z,{activePage:ie.vS.explore,children:[this.renderMetaData(),this.renderLoader()]})}fetchTrendingTagsState(){const{apiFetch:e}=this.props.appContext;this.setState({isFetchingTrendingTags:!0},(()=>(0,fe.Ks)(e).then((e=>this.setState({...e,isFetchingTrendingTags:!1})))))}fetchRecommendedTagsState(){const{apiFetch:e,isLoggedIn:t}=this.props.appContext;this.setState({isFetchingRecommendedTags:!0},(()=>(0,fe.zJ)(e,t).then((e=>this.setState({...e,isFetchingRecommendedTags:!1})))))}fetchStaffPicksTagsState(){const{apiFetch:e}=this.props.appContext;this.setState({isFetchingStaffPicksTags:!0},(()=>(0,fe.lu)(e).then((e=>this.setState({...e,isFetchingStaffPicksTags:!1})))))}fetchTags(){switch(this.getExploreMode()){case ae.Ru.Trending:Ne(this.state)||this.state.isFetchingTrendingTags||this.fetchTrendingTagsState();break;case ae.Ru.Recommended:Le(this.state)||this.state.isFetchingRecommendedTags||this.fetchRecommendedTagsState();break;case ae.Ru.StaffPicks:Be(this.state)||this.state.isFetchingStaffPicksTags||this.fetchStaffPicksTagsState()}}fetchFollowedTagsState(){const{apiFetch:e}=this.props.appContext;this.setState({isFetchingFollowedTags:!0},(()=>(0,he.KN)(e).fetch().then((e=>{let{response:{timeline:t}}=e;return this.setState({followedTagsTimeline:t,isFetchingFollowedTags:!1})}))))}fetchRecommendedBlogsState(){const{apiFetch:e}=this.props.appContext;this.setState({isFetchingRecommendedBlogs:!0},(()=>(0,de.Iv)(e).fetch().then((e=>{let{response:{timeline:t}}=e;return this.setState({recommendedBlogsTimeline:t,isFetchingRecommendedBlogs:!1})}))))}fetchTrendingBlogsState(){const{apiFetch:e}=this.props.appContext;this.setState({isFetchingTrendingBlogs:!0},(()=>(0,de.E1)(e).fetch().then((e=>{let{response:{timeline:t}}=e;return this.setState({trendingBlogsTimeline:t,isFetchingTrendingBlogs:!1})}))))}fetchSidebar(){const{isLoggedIn:e}=this.props.appContext,{isFetchingTrendingBlogs:t,isFetchingFollowedTags:s,isFetchingRecommendedBlogs:i}=this.state,n=this.getExploreMode();e&&n!==ae.Ru.Trending||Pe(this.state)||t||this.fetchTrendingBlogsState(),e&&(Ee(this.state)||s||this.fetchFollowedTagsState(),n===ae.Ru.Trending||ye(this.state)||i||this.fetchRecommendedBlogsState())}}const Oe=(0,P.Bg)(De,{appContext:!0,viewportContext:!0})},75891:(e,t,s)=>{s.d(t,{Z:()=>n});var i=s(22979);function n(e,t){return(0,i.eO)(e)?{...e,display:{...e.display,title:t}}:e}}}]);