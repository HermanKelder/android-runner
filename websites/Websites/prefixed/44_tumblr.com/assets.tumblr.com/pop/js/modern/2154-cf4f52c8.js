"use strict";(self.webpackChunk_tumblr_redpop=self.webpackChunk_tumblr_redpop||[]).push([[2154],{52948:(t,e,s)=>{s.d(e,{Z:()=>n});var o=s(95004),r=s(29158),l=s(2629);class i extends o.Component{shouldComponentUpdate(){return!!this.props.shouldUpdate}render(){return this.props.children}}const n=t=>{let{className:e,index:s,children:o,shouldUpdate:n=!1}=t;return(0,l.jsx)(r.Z.Consumer,{children:t=>{let{window:r}=t;const c=r[s]?r[s].opacity:0;return(0,l.jsx)("div",{style:{opacity:c},className:e,children:(0,l.jsx)(i,{shouldUpdate:n,children:o})})}})}},29158:(t,e,s)=>{s.d(e,{Z:()=>r});var o=s(95004);const r=(0,o.createContext)({window:{},scrollContainerRef:(0,o.createRef)()})},90855:(t,e,s)=>{s.d(e,{Z:()=>x});var o=s(50209),r=s.n(o),l=s(5754),i=s.n(l),n=s(95004),c=s(79615),h=s(68144),a=s(78667),d=s(21283),p=s(94576),u=s(29158);const m="kDCXR",v="GTDnP",C="wOp1Q",f="jxu4l";var g=s(2629);const S=1/30*1e3;class R extends n.Component{constructor(){super(...arguments),r()(this,"state",{scrollPosition:0,containerWidth:0,scrollWidth:0}),r()(this,"scrollContainerRef",(0,n.createRef)()),r()(this,"onScroll",(0,d.Z)((()=>{const t=this.scrollContainerRef.current?Math.max(this.scrollContainerRef.current.scrollLeft,0):0;this.setState({scrollPosition:t})}),S)),r()(this,"scrollChildrenDidChange",(0,d.Z)((()=>{var t;const e=null===(t=this.scrollContainerRef.current)||void 0===t?void 0:t.scrollWidth;void 0!==e&&this.setState({scrollWidth:e})}),250)),r()(this,"onResize",(0,d.Z)((()=>{var t,e,s,o;this.setState({containerWidth:null===(t=this.scrollContainerRef)||void 0===t||null===(e=t.current)||void 0===e?void 0:e.clientWidth,scrollWidth:null===(s=this.scrollContainerRef)||void 0===s||null===(o=s.current)||void 0===o?void 0:o.scrollWidth})}),S)),r()(this,"scrollLeft",(()=>{this.scroll(!1)})),r()(this,"scrollRight",(()=>{this.scroll(!0)})),r()(this,"scroll",(t=>{const e=this.scrollContainerRef.current,{itemWidth:s,maxItemsToScroll:o,visibleWidth:r}=this.props,{containerWidth:l,scrollPosition:i}=this.state;if(!e)return;const n=Math.min(r,l),c=n/s,h=Math.min(o??1/0,Math.round(c/2)),a=Math.max(h,1)*(t?1:-1);if(this.props.onScroll){const e=i,o=n+i,r=Math.floor(e/s),l=Math.floor(o/s);if(!1===this.props.onScroll({firstIndex:r,lastIndex:l,right:t}))return}const d=Math.abs(2*s*a);!t&&i<d?e.scrollTo({left:0,behavior:"smooth"}):e.scrollBy({left:s*a,behavior:"smooth"})})),r()(this,"onScrollContainerResize",(t=>{const[{target:e}]=t;this.setState({containerWidth:e.clientWidth,scrollWidth:e.scrollWidth})}))}componentDidMount(){const t=this.scrollContainerRef.current;p.ZP.on("resize",this.onResize),t&&(this.resizeObserver=new ResizeObserver(this.onScrollContainerResize),this.resizeObserver.observe(t)),this.setState({scrollWidth:(null==t?void 0:t.scrollWidth)||0,containerWidth:null==t?void 0:t.clientWidth}),t&&(this.mutationObserver=new MutationObserver(this.scrollChildrenDidChange),this.mutationObserver.observe(t,{childList:!0,subtree:!0}))}componentWillUnmount(){var t,e;p.ZP.off("resize",this.onResize),null===(t=this.mutationObserver)||void 0===t||t.disconnect(),null===(e=this.resizeObserver)||void 0===e||e.disconnect(),this.scrollChildrenDidChange.cancel(),this.onScroll.cancel()}render(){const{children:t,visibleWidth:e,className:s,scrollContainerClassName:o,arrowButtonClassName:r,itemWidth:l,maxItemsToScroll:n,appContext:{_t:a}}=this.props,{scrollPosition:d,containerWidth:p,scrollWidth:S}=this.state,R=`calc((100% - ${e}px) / 2)`,x=void 0===n?d<l/2:S===p,b=void 0===n?d+p>=S-1:S===p;return(0,g.jsx)("div",{className:i()(s,m),children:(0,g.jsx)("div",{className:i()(o,f),onScroll:this.onScroll,ref:this.scrollContainerRef,children:(0,g.jsxs)(u.Z.Provider,{value:{window:this.calculateWindowBasedOnScroll(d),scrollContainerRef:this.scrollContainerRef},children:[(0,g.jsx)("div",{style:{paddingLeft:R}}),t,(0,g.jsx)("div",{style:{paddingRight:R}}),(0,g.jsx)(c.Z,{className:i()(v,r,{[C]:x}),style:{left:0,paddingLeft:R},label:a("Scroll carousel left"),onClick:this.scrollLeft,children:(0,g.jsx)(h.UX,{size:{height:40,width:40}})}),(0,g.jsx)(c.Z,{className:i()(v,r,{[C]:b}),style:{right:0,paddingRight:R},label:a("Scroll carousel right"),onClick:this.scrollRight,children:(0,g.jsx)(h.jV,{size:{height:40,width:40}})})]})})})}calculateWindowBasedOnScroll(t){const{visibleWidth:e,itemWidth:s}=this.props,o=e+t,r=t/s,l=Math.floor(r),i=1-(r-l),n=Math.min(1.5*i,1),c=o/s,h=Math.floor(c),a=c-h,d={[l]:{opacity:n},[h]:{opacity:Math.min(1.5*a,1)}};for(let t=l+1;t<h;t+=1)d[t]={opacity:1};return d}}const x=(0,a.HJ)(R)},38113:(t,e,s)=>{s.d(e,{Z:()=>h});var o=s(5754),r=s.n(o),l=s(73683);const i="WWBSO",n="_y4kh";var c=s(2629);const h=t=>{let{children:e,className:s,wrapperClassName:o,...h}=t;return(0,c.jsx)(l.rU,{className:r()(i,o),...h,children:(0,c.jsx)("span",{className:r()(n,s),tabIndex:-1,children:e})})}},26705:(t,e,s)=>{s.d(e,{ZP:()=>v});var o=s(50209),r=s.n(o),l=s(95004),i=s(63665),n=s(78667),c=s(7070),h=s(64051),a=s(2493),d=s(2629);class p extends h.Z{constructor(){super(...arguments),r()(this,"addObjectsToExisting",(t=>{const{objects:e}=this.state,{direction:s,getObjectsFromResponse:o}=this.props;return s===i.cU.Top?o(t).concat(e):e.concat(o(t))})),r()(this,"preHandleContentFetch",(t=>{const{updateUrlFromCurrentPageLink:e}=this.props;if(t===i.vO.Refresh)null==e||e()}))}render(){const{fetchDistance:t,direction:e,scrollContainer:s,debug:o,loader:r}=this.props,{loadingNextPage:n,nextLink:c}=this.state,h=r&&(null==c?void 0:c.href)&&(0,l.cloneElement)(r,{style:{...r.props.style,visiblity:""+(n?"visible":"hidden")}}),p=e===i.cU.Top;return(0,d.jsxs)(a.Z,{onScrollToEdge:this.fetchNextPage,edgeDistance:t,scrollContainer:s,direction:e,debug:o,children:[p&&h,super.render(),!p&&h]})}}r()(p,"defaultProps",{...h.c,fetchDistance:400});const u=(0,n.tM)(p);(0,c.D)(u,`Inner${u.name}`);class m extends l.Component{render(){return(0,d.jsx)(u,{...this.props,ref:this.props.forwardedRef})}}const v=m},2493:(t,e,s)=>{s.d(e,{Z:()=>h});var o=s(50209),r=s.n(o),l=s(95004),i=s(63665),n=s(21283),c=s(94576);class h extends l.PureComponent{constructor(){super(...arguments),r()(this,"checkContainedScroll",(0,n.Z)((()=>{const{scrollContainer:t}=this.props;!this.willUnmount&&(0,i.Re)(t)&&this.checkScroll({distanceFromTop:t.scrollTop,distanceFromBottom:t.scrollHeight-t.clientHeight-t.scrollTop,distanceFromRight:t.scrollWidth-t.scrollLeft-t.clientWidth})}),c.ZQ)),r()(this,"forceCheckScroll",(()=>{(0,i.Re)(this.props.scrollContainer)?this.checkContainedScroll():this.checkScroll(c.ZP.getInfo())})),r()(this,"checkScroll",(t=>{let{distanceFromBottom:e,distanceFromTop:s,distanceFromRight:o}=t;const{direction:r,edgeDistance:l,onScrollToEdge:n}=this.props;let c;switch(r){case i.cU.Top:c=s;break;case i.cU.Bottom:c=e;break;case i.cU.Right:c=o}void 0!==l&&void 0!==c&&l>=c&&n()})),r()(this,"updateScrollTop",(t=>{const e=(0,i.Re)(this.props.scrollContainer)?this.props.scrollContainer:document.body,{lastScrollHeight:s,lastClientHeight:o,lastScrollTop:r}=t;let l=e.scrollTop+e.scrollHeight-s;o!==e.clientHeight&&(l+=o-e.clientHeight);const n=r-e.scrollTop;n&&(l+=n),l!==e.scrollTop&&(e.scrollTop=l)}))}componentDidMount(){this.attachEventListeners(),this.forceCheckScroll()}componentWillUnmount(){this.willUnmount=!0,this.removeEventListeners()}getSnapshotBeforeUpdate(t){const{direction:e}=this.props,{scrollContainer:s}=t;if(e!==i.cU.Top)return null;const o=(0,i.Re)(s)?s:document.body;return{lastScrollHeight:o.scrollHeight,lastClientHeight:o.clientHeight,lastScrollTop:o.scrollTop}}componentDidUpdate(t,e,s){(0,i.Re)(this.props.scrollContainer)&&t.scrollContainer!==this.props.scrollContainer&&(this.removeEventListeners(t),this.attachEventListeners()),s&&this.updateScrollTop(s),this.forceCheckScroll()}render(){return this.props.children}attachEventListeners(){(0,i.Re)(this.props.scrollContainer)?this.props.scrollContainer.addEventListener("scroll",this.checkContainedScroll,!1):c.ZP.on("scroll",this.checkScroll)}removeEventListeners(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props;(0,i.Re)(t.scrollContainer)&&t.scrollContainer.removeEventListener("scroll",this.checkContainedScroll,!1),c.ZP.off("scroll",this.checkScroll)}}}}]);